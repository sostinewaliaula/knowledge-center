# Frontend UUID Usage Guide

## ‚úÖ UUID Auto-Generation is Active

**All 34 tables use UUIDs with automatic generation!**

UUIDs are automatically generated by MySQL using `DEFAULT (uuid())` whenever you insert a new record. **You don't need to do anything special** - just omit the `id` field when creating records.

## How It Works

### For Frontend Developers

When creating data through the API:

#### ‚úÖ DO THIS (Correct):
```javascript
// Creating a course - NO 'id' field needed!
const response = await fetch('/api/courses', {
  method: 'POST',
  headers: { 'Content-Type': 'application/json' },
  body: JSON.stringify({
    title: 'New Course',
    slug: 'new-course',
    description: 'Course description',
    category_id: 'some-category-uuid',
    status: 'draft'
    // ‚úÖ NO 'id' field - database will generate it automatically!
  })
});

const { course } = await response.json();
console.log(course.id); // ‚úÖ Auto-generated UUID will be in the response
```

#### ‚ùå DON'T DO THIS (Wrong):
```javascript
// ‚ùå Don't manually create UUIDs
import { v4 as uuidv4 } from 'uuid';
const courseId = uuidv4();

const response = await fetch('/api/courses', {
  method: 'POST',
  body: JSON.stringify({
    id: courseId, // ‚ùå Don't include ID!
    title: 'New Course',
    // ...
  })
});
```

## Tables with Auto-Generated UUIDs

**All 34 tables** automatically generate UUIDs, including:
- ‚úÖ `users`, `roles` - Authentication
- ‚úÖ `categories`, `tags`, `courses`, `modules`, `lessons` - Content
- ‚úÖ `enrollments`, `lesson_progress` - Learning tracking
- ‚úÖ `assessments`, `assessment_questions`, `assessment_attempts` - Assessments
- ‚úÖ `certificates`, `compliance_requirements` - Certifications
- ‚úÖ `notifications`, `live_sessions`, `discussions` - Communication
- ‚úÖ `badges`, `user_points` - Gamification
- ‚úÖ And all other tables!

See `ALL_UUIDS_COMPLETE.md` for the complete list.
15. ‚úÖ `compliance_requirements` - Compliance rules
16. ‚úÖ `notifications` - User notifications
17. ‚úÖ `live_sessions` - Live training sessions
18. ‚úÖ `discussions` - Course discussions
19. ‚úÖ `discussion_replies` - Discussion replies
20. ‚úÖ `badges` - Gamification badges
21. ‚úÖ `departments` - Departments
22. ‚úÖ `user_groups` - User groups
23. ‚úÖ `content_library` - Uploaded files

## Complete Example

### Creating a Course with Modules and Lessons

```javascript
// 1. Create course (UUID auto-generated)
const courseResponse = await api.post('/api/courses', {
  title: 'Insurance Fundamentals',
  slug: 'insurance-fundamentals',
  description: 'Learn insurance basics',
  category_id: categoryId, // UUID from another table
  status: 'published'
  // ‚úÖ No 'id' field
});

const course = courseResponse.course;
console.log('Course created with ID:', course.id); // Auto-generated UUID

// 2. Create module (UUID auto-generated)
const moduleResponse = await api.post('/api/modules', {
  course_id: course.id, // Use the UUID from step 1
  title: 'Module 1: Introduction',
  order_index: 1
  // ‚úÖ No 'id' field
});

const module = moduleResponse.module;
console.log('Module created with ID:', module.id); // Auto-generated UUID

// 3. Create lesson (UUID auto-generated)
const lessonResponse = await api.post('/api/lessons', {
  module_id: module.id, // Use the UUID from step 2
  title: 'Lesson 1: What is Insurance?',
  content_type: 'text',
  order_index: 1
  // ‚úÖ No 'id' field
});

const lesson = lessonResponse.lesson;
console.log('Lesson created with ID:', lesson.id); // Auto-generated UUID
```

### Creating an Enrollment

```javascript
const enrollment = await api.post('/api/enrollments', {
  user_id: currentUser.id, // INT ID
  course_id: course.id, // UUID
  status: 'enrolled'
  // ‚úÖ No 'id' field - auto-generated!
});

console.log('Enrollment ID:', enrollment.id); // Auto-generated UUID
```

### Creating a Notification

```javascript
const notification = await api.post('/api/notifications', {
  user_id: userId, // INT ID
  title: 'Welcome!',
  message: 'Welcome to Knowledge Center',
  type: 'info'
  // ‚úÖ No 'id' field - auto-generated!
});
```

## API Response Format

All API responses will include the auto-generated UUID:

```json
{
  "success": true,
  "course": {
    "id": "b0927a7dcd6511f0b31000155d3cc340",  // ‚úÖ Auto-generated UUID
    "title": "New Course",
    "slug": "new-course",
    "created_at": "2025-01-15T10:30:00Z"
  }
}
```

## Important Notes

1. **UUID Format**: 32 characters, no dashes (e.g., `b0927a7dcd6511f0b31000155d3cc340`)

2. **Foreign Keys**: When referencing UUID tables, use the UUID string:
   ```javascript
   {
     course_id: "b0927a7dcd6511f0b31000155d3cc340", // ‚úÖ UUID string
     user_id: 123 // ‚úÖ INT for users table
   }
   ```

3. **Updates**: When updating, include the UUID:
   ```javascript
   // Update requires the UUID
   await api.put(`/api/courses/${course.id}`, {
     title: 'Updated Title'
     // Don't need to send 'id' in body, it's in the URL
   });
   ```

4. **Deletes**: Use UUID in URL:
   ```javascript
   await api.delete(`/api/courses/${course.id}`); // UUID in URL
   ```

## Verification

The system has been tested and verified:
- ‚úÖ All 23 triggers created successfully
- ‚úÖ UUID generation working (tested with categories table)
- ‚úÖ UUIDs are 32 characters (no dashes)
- ‚úÖ Works for all UUID tables

## Summary

**Just remember:** When creating new records via the API, **don't include the `id` field**. The database will automatically generate a UUID for you, and it will be returned in the API response.

That's it! UUID generation is completely transparent - it just works! üéâ

