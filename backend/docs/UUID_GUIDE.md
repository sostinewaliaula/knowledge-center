# UUID Auto-Generation Guide

## Overview

UUIDs are **automatically generated by MySQL** using the `DEFAULT (uuid())` feature. This means you never need to manually generate or include UUIDs when inserting records - MySQL does it for you!

## How It Works

### Database Level

All UUID tables use `DEFAULT (uuid())` in their table definitions:

```sql
CREATE TABLE categories (
  id CHAR(36) NOT NULL DEFAULT (uuid()) PRIMARY KEY,
  name VARCHAR(100) NOT NULL,
  ...
);
```

This means:
- ✅ MySQL automatically generates UUIDs when `id` is not provided
- ✅ UUIDs are in standard format: `60d4926d-e2bf-4ce3-a3a6-cd7abf97d837` (36 chars with dashes)
- ✅ No triggers needed
- ✅ No application code needed to generate UUIDs

## Usage

### In SQL (Migrations/Sample Data)

**✅ Correct - Just omit the 'id' field:**

```sql
INSERT INTO categories (name, slug, description) 
VALUES ('Insurance Fundamentals', 'insurance-fundamentals', 'Core concepts');
-- MySQL automatically generates the UUID for 'id'
```

**❌ Incorrect - Don't include 'id':**

```sql
-- Don't do this - let MySQL generate it
INSERT INTO categories (id, name, slug) 
VALUES ('some-uuid', 'Insurance', 'insurance');
```

### In Application Code (Models/Controllers)

**✅ Correct - Omit 'id' field:**

```javascript
// Creating a course - MySQL will auto-generate UUID
const sql = `
  INSERT INTO courses (title, slug, description, category_id)
  VALUES (?, ?, ?, ?)
`;
await query(sql, [title, slug, description, categoryId]);

// MySQL automatically generates the UUID for 'id'
```

**✅ If you need the ID after insert:**

```javascript
const sql = `
  INSERT INTO courses (title, slug, description, category_id)
  VALUES (?, ?, ?, ?)
`;
await query(sql, [title, slug, description, categoryId]);

// Get the created course
const course = await queryOne(
  'SELECT * FROM courses WHERE slug = ?',
  [slug]
);
console.log(course.id); // Auto-generated UUID
```

### From Frontend (API Calls)

**✅ Correct - Don't send 'id' in request:**

```javascript
const response = await fetch('/api/courses', {
  method: 'POST',
  headers: { 'Content-Type': 'application/json' },
  body: JSON.stringify({
    title: 'New Course',
    slug: 'new-course',
    description: 'Course description'
    // ✅ NO 'id' field - MySQL generates it automatically!
  })
});

const { course } = await response.json();
console.log(course.id); // Auto-generated UUID from MySQL
```

## Tables with Auto-Generated UUIDs

**All 34 tables** automatically generate UUIDs, including:
- ✅ Authentication: `roles`, `users`, `otp_codes`, `password_resets`
- ✅ Content: `categories`, `tags`, `courses`, `modules`, `lessons`
- ✅ Learning: `enrollments`, `lesson_progress`, `learning_paths`
- ✅ Assessments: `assessments`, `assessment_questions`, `assessment_attempts`
- ✅ And all other tables!

See `ALL_UUIDS_COMPLETE.md` for the complete list.

## UUID Format

- **Format**: Standard UUID v4 with dashes
- **Example**: `60d4926d-e2bf-4ce3-a3a6-cd7abf97d837`
- **Length**: 36 characters (32 hex + 4 dashes)
- **Column Type**: `CHAR(36)`

## Summary

- ✅ **MySQL automatically generates UUIDs** using `DEFAULT (uuid())`
- ✅ **Just omit the `id` field** when inserting records
- ✅ **No triggers needed** - clean database
- ✅ **Works everywhere** - SQL, application code, and frontend
- ✅ **Simple and clean** - MySQL handles everything!

## Benefits

1. **Automatic** - No need to generate UUIDs manually
2. **Consistent** - All UUIDs generated the same way
3. **Clean** - No triggers or application code needed
4. **Standard** - Uses MySQL's built-in UUID() function
5. **Simple** - Just omit `id` when inserting!
